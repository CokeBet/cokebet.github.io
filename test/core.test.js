const {test} = require('tap');
const {getBetHash, checkRSASign} = require('../lib/core');

const info = {
  betMoney: '10000',
  betNumber: 50,
  channelId: '0xc6b359bcdfb3fa50d27c1ef38499d10a054434b7bdc7cf47e791d7295a859bfb',
  rndSig: '26e042835f10afd0cd29d18c232f83e1cc1f07f28257cce21f343ad8c4de2b26a2117b34e3c860bf5ad89eed378dadca4d430631aea2728391ab6ae274787b35fd1c86585cc56c8ebec72520ca769fd21ac3ba573742bb5afff6ac0a1b36e83a6f2a85a3f997f476b2bdf4d6dde189524768b5e797e34d7397db0239e7647033',
  rsaE: '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003',
  rsaN: '7b2909ee865515fd02dfc37e8fec2241c5464098039ba692671738c4aded349834bfa16c73aab42a898e39872cdeaf42a29ec41581c262a9c9b76a55327ed80f33bd3897a4046b0119cd0899b2a00d142b08131517c75751749a56cf5741d8e3feebbdda71007540803abe11ad696321ab8c4db8113193ce1eab3ed98de314a3',
  seed: '1548294356546',
  session: 2
};

test('getBetHash', t => {
  t.plan(1);
  const betHash = getBetHash(info);
  console.log(`==> ${betHash}`);
  t.equal(betHash, '0x49793bba95910067f875294bc574026ed377b0880367076673d7e7a827ee6d12');
});

test('checkRSASign', t => {
  t.plan(1);
  const pass = checkRSASign(info);
  t.ok(pass);
});
