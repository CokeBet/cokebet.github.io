const {test} = require('tap');
const {getBetHash, checkRSASign} = require('../lib/core');

const info = {
  'channelId': '0x30f26fec7216e45fbafe4c33869abdd2141b2b18898943831484e6bd546e1339',
  'session': 1,
  'betMoney': '0.01',
  'betNumber': 50,
  'seed': 1551333459577,
  'rndSig': '420556a4b9edfe2ca9b4c745aa115a086df7caeb033385cf1dffb184b816ff8e93dca26af099506cf25d49b34c0c128f4ac5144b93ccb138f36b1b1d8c4d49d5cd0cd957b433255a3a5e0e373c722400afaec72aae93e90ada627c614dc8a264a87416d7d315154e00d0e6ed1d01c80be54ebf47f432b496ace640ab4c6fcd56',
  'rsaN': '5c8b5f36134469c5732159847842bc7a413be914e697fc624bfe9a42f866149d49b318c43ef6eef464926519fa49dbd95b4bc76e8a04d2c782bf7f1efa7d4f3a0c8b38cba23b49ec7de70c0bf1f8bbf14705cd175574bf6512dae5b6eca95c783b6a2544842a1ba7aaa1c6c25cdcaa7173cbf18dead253a0dfe8e569628d0a4f',
  'rsaE': '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003'
};

test('getBetHash', t => {
  t.plan(1);
  const betHash = getBetHash(info);
  console.log(`==> ${betHash}`);
  t.equal(betHash, '0x62587f6fe254d28f6c2d8b2fc8944d82d476ab621aa55fe8854ab8d8c72934f7');
});

test('checkRSASign', t => {
  t.plan(1);
  const pass = checkRSASign(info);
  t.ok(pass);
});
